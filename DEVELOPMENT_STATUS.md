# 開発ステータスと今後の計画 (2025-12-12)

このドキュメントは、Shopify CSV出力機能に関する現在の実装状況と、今後の開発計画をまとめたものです。

## Shopify CSV連携 要件リスト

Shopifyの商品編集画面を元に、ツール側で設定・CSV出力したい項目。

### 1. 商品（Product）レベルの項目

- **Status（ステータス）**: `active` / `draft`
- **Title（商品名）**
- **Body（HTMLの商品説明）**
- **Images（画像URL）**
- **Vendor（販売元）**
- **Tags（タグ）**
- **SEO**: `ページタイトル`, `メタディスクリプション`
- **Handle（URLハンドル）**

### 2. バリエーション（Variant）レベルの項目

- **Variant Price（価格）**
- **Taxable（税金）**: デフォルト「いいえ」希望
- **Variant Inventory Qty（在庫数）**
- **Variant SKU（SKU）**: 固有ワードをツール側で生成・設定したい
- **Variant Grams（重量）**
- **配送/税関**: `原産国`, `HSコード`

### 3. 複数バリエーションの項目

- **Option1 Name（オプション名）**
- **Option1 Value（オプション値）**
- (各バリエーションごとの価格・在庫)

---

## 機能実装ステータス

| 機能項目 | ステータス | 備考 |
| :--- | :--- | :--- |
| **Title（商品名）** | ✅ 実装済み | 編集・出力に対応 |
| **Body（商品説明）** | ✅ 実装済み | 編集・出力、テンプレート機能に対応 |
| **Images（画像URL）** | ✅ 実装済み | 出力に対応 |
| **Variant Price（価格）** | ✅ 実装済み | 編集・出力、利益率計算に対応 |
| **Variant Inventory Qty（在庫数）** | ✅ 実装済み | 新規・在庫更新CSVに対応 |
| **Vendor（販売元）** | ⚠️ 部分的に実装 | 現在はサイト名が自動入力される。手動編集機能が必要。 |
| **Handle（URLハンドル）** | ⚠️ 部分的に実装 | 現在は `mercari-{ID}` が自動入力される。手動編集機能が必要。 |
| **Status（ステータス）** | ❌ 未実装 | |
| **Tags（タグ）** | ❌ 未実装 | |
| **SEO関連** | ❌ 未実装 | |
| **Taxable（税金）** | ❌ 未実装 | |
| **Variant SKU** | ❌ 未実装 | |
| **Variant Grams（重量）** | ❌ 未実装 | |
| **配送/税関関連** | ❌ 未実装 | |
| **複数バリエーション** | ❌ 未実装 | **大規模改修が必要** |

---

## 今後の開発計画

### Step 1: 単一バリエーション機能の拡充（優先度: 高）

まず、複数バリエーション以外の、比較的容易に追加できる項目をすべて実装する。

1.  **データベース拡張**: `Product` モデルに未実装項目に対応するカラムを追加する。
    - `status`, `tags`, `seo_title`, `seo_description`, `vendor`, `handle`, `taxable`, `sku`, `grams`, `country_of_origin`, `hs_code` など。
2.  **UI改修**: 商品編集画面に、上記項目を入力するためのフォームを追加する。
3.  **CSV出力機能の更新**: `export_shopify` 関数を改修し、追加したすべての項目がCSVに正しく反映されるようにする。

### Step 2: 複数バリエーション対応（優先度: 中）

Step 1が完了した後、次の大きな開発フェーズとして取り組む。

- **根本的な設計変更が必要**:
  - 「バリエーション」を管理するための新しいデータベーステーブルを追加する。
  - 商品編集画面を、複数のバリエーションを動的に管理できるUIに作り替える。
  - CSV出力ロジックを、複数バリエーションの行を正しく生成できるように改修する。
- この機能はアプリケーションの構造に大きく影響するため、慎重な計画と実装が求められる。
