それでは、収集した情報を基に詳細な機能要件をまとめます。

---

# 📑 DeepBay 詳細機能要件書（逆引き分析）

## 🎯 システム概要

**DeepBay**は、日本のECサイトから商品情報を自動抽出し、eBayへの無在庫販売を支援するWebアプリケーション。商品データの取得・編集・翻訳・出品・在庫管理までを一元管理する統合プラットフォーム。

---

## 🏗️ システムアーキテクチャ

### アクセス方式
- **WebベースSaaS**: https://deepbay.app/
- **推奨ブラウザ**: Google Chrome
- **認証**: メールアドレス・パスワード認証
- **外部連携**: Bee（姉妹ツール）経由でeBay APIと接続

### マルチアカウント対応
- 複数のeBayセラーアカウントを1つのDeepBayアカウントで管理可能
- セラーごとに独立した設定・在庫管理が可能

---

## 📦 主要機能モジュール

## 1. 商品抽出機能（Product Extraction）

### 1.1 一括抽出（Bulk Extraction）
**目的**: ECサイトの商品一覧ページから複数商品を一度に取得

#### 入力パラメータ
- **抽出対象URL**: ECサイトの商品一覧ページURL
- **出品カテゴリID**: eBayカテゴリ番号（事前登録済みから選択）
- **出品セラー**: 対象のeBayアカウント選択
- **一括編集設定**: 適用する編集ルールセット選択

#### 処理フロー
1. URLからページコンテンツを取得（スクレイピング）
2. プランに応じた上限件数まで商品データを抽出
   - スタータープラン: 30商品/回
   - ビギナー: 100商品/回
   - スタンダード〜プレミアム: 600商品/回
   - アンカー: 800商品/回
3. 抽出した生データに一括編集設定を適用
4. 除外条件に該当する商品をフィルタリング
5. 商品一覧画面に結果を表示（処理進捗100%で完了）

#### 抽出データ項目
- 商品タイトル（日本語）
- 商品価格（仕入値）
- 商品画像（最大12枚まで取得可能）
- 商品説明文
- セラー情報（評価数、評価率）
- 商品状態（新品/中古）
- 配送情報
- 商品URL（仕入元リンク）

### 1.2 シングル抽出（Single Extraction）
**目的**: 個別商品ページから1商品のみを抽出

#### 特徴
- 商品個別ページURLから直接抽出
- 一括抽出と同じ入力パラメータ
- 抽出回数カウントは別管理（月間制限あり）

### 1.3 自動抽出（Automated Extraction）
**目的**: スケジュール設定による無人運用

#### 設定項目
- **基本設定**
  - 抽出対象URL
  - 出品カテゴリ
  - 出品セラー
  
- **詳細設定**
  - **処理タイプ**: 「抽出のみ」または「出品まで実行」
  - **稼働曜日**: 毎週特定の曜日（複数選択可）
  - **稼働時間**: 時刻指定
  - **出品数**: 抽出する商品数
  - **一括編集設定**: 適用する編集ルール
  - **出品ポリシー**: 使用するeBayポリシー

#### 動作
- 設定した日時に自動実行
- デフォルトで月間3件まで登録可能（オプションで拡張）
- 1ヶ月分のスケジュールをまとめて登録可能

---

## 2. 抽出管理機能（Extraction Management）

### 2.1 出品カテゴリー管理
**目的**: eBayカテゴリIDの事前登録・再利用

#### 機能
- カテゴリID登録
- カテゴリ識別名設定（自由命名）
- タイトルからカテゴリ自動予測機能
  - 商品名入力 → AI予測 → カテゴリID自動取得

### 2.2 一括編集設定（Batch Edit Settings）
**目的**: 抽出時に自動適用される編集ルールセットの管理

#### 設定可能項目

##### 除外設定（Exclusion Rules）

**VERO・危険セラー・危険単語除外**
- VERO（Verified Rights Owner）登録商標の除外
- 危険セラーリストによる除外
- 危険単語リストによる除外
- 有効/無効切り替え可能

**選択ワード除外**
- 設定ごとに独自の除外キーワード登録
- 部分一致・完全一致での除外対応
- 例: 「まとめ売り」「ジャンク」「訳あり」

**価格範囲フィルター**
- 最低価格・最高価格の範囲指定
- 範囲外の商品を自動除外

**セラー評価フィルター**
- 合計評価数の最低値設定
- 低評価数（マイナス評価）の上限設定
- 新規セラーの除外

**時間・配送フィルター**
- 更新日時による除外（古い出品を除外）
- 配送方法による除外

##### 編集設定（Edit Rules）

**タイトル編集**
- 80文字以内に自動調整（eBay制約）
- 不要な記号・絵文字の削除
- ブランド名の強調
- キーワードの並び替え
- 自動翻訳（日本語→英語）
- 翻訳レベル選択（フルパッケージオプション）

**ブランド編集**
- ブランド名の自動抽出
- ブランドフィールドへの自動入力

**価格計算**
- 仕入値に対する利益率設定
- 固定金額の加算
- 送料上乗せ
- 為替レート自動反映
- 計算式: `販売価格 = (仕入値 × 利益率) + 固定額 + 送料`

**HTMLディスクリプション**
- 事前登録したHTMLテンプレート選択
- 商品説明の自動生成
- 画像配置・レイアウト自動調整
- スマホ対応レスポンシブデザイン

**ベストオファー設定**
- 自動受諾価格の設定（％指定）
- 自動拒否価格の設定（％指定）

**商品状態設定**
- 新品（New）/中古（Used）の自動判定
- 特殊カテゴリー向け詳細コンディション設定
  - カメラ: Mint, Excellent, Good など
  - 鑑定品（Authenticated）対応

**その他設定**
- 画像枚数調整（最大12枚）
- 画像順序の調整
- 先頭画像・末尾画像の削除

### 2.3 複数設定パターン管理
- 一括編集設定は複数パターン作成可能
- 設定名・メモによる管理
- 新規作成・削除・複製機能
- カテゴリ別、仕入先別に使い分け可能

---

## 3. 商品編集機能（Product Editing）

### 3.1 簡易編集モード（Quick Edit Mode）
**目的**: 大量商品の高速スクリーニング

#### 機能
- **一覧表示**: サムネイル+価格+タイトル
- **ワンクリック削除**: ゴミ箱アイコンで即削除
- **リンクジャンプ**: 商品ページへ直接遷移
- **画像プレビューサイズ変更**: 大・中・小の3段階
- **自動スクロール機能**
  - カーソルを画面下に置くと自動スクロール
  - スクロール速度調整可能
  - 効率的な大量商品レビューをサポート

### 3.2 詳細編集モード（Detailed Edit Mode）
**目的**: 個別商品の細かな編集

#### 編集項目
- **タイトル**: 手動編集、80文字カウント表示
- **価格**: 販売価格の個別調整
- **画像管理**
  - ドラッグ&ドロップで順序変更
  - 個別削除
  - キーボードショートカット対応
    - `C`: 末尾の画像削除
    - `X`: 先頭の画像削除
    - `Space`: 商品削除
    - `V`: 前のページへ
- **商品説明**: HTMLエディタで編集
- **アイテムスペシフィックス（Item Specifics）**: 細かい属性設定
- **カテゴリ**: 個別変更可能
- **商品状態**: 新品/中古の変更
- **オファー設定**: ベストオファーの個別調整

#### 自動ムーブ機能
- 設定した待機時間（ミリ秒単位）で商品を自動切り替え
- ハンズフリーでの商品レビューが可能

### 3.3 追加編集機能

#### 検索・並び替え
- タイトル・説明文内のキーワード検索
- 価格順・タイトル順の並び替え
- 「並び替えなし」モードで編集中の誤移動防止

#### タグ付け・メモ機能
- 商品ごとに色分けタグ付与
- 自由記述メモ
- 抽出リスト名の自動/手動入力

#### 一括操作
- 複数商品の一括削除
- 一括価格変更
- 一括カテゴリ変更

### 3.4 データ検証機能
**目的**: eBay出品エラーの事前防止

#### 自動バリデーション
編集保存時に以下をチェック:
- タイトルが0文字または80文字超過
- 販売価格が0ドル
- 商品画像が0枚
- オファー値が1〜100%の範囲外
- 数値フィールドに全角文字

#### エラーハンドリング
- 不正商品を確認ボタンでエラー箇所へジャンプ
- ビックリマークで該当商品をハイライト
- 赤色文字数カウントでエラー箇所を明示
- すべて修正完了後に保存可能

---

## 4. 出品機能（Listing Functions）

### 4.1 ダイレクト出品（Direct Listing）
**目的**: DeepBayからeBayへ直接出品

#### 処理フロー
1. 出品セラー選択
2. 各種eBayポリシー選択
   - 支払いポリシー（Payment Policy）
   - 返品ポリシー（Return Policy）
   - 配送ポリシー（Shipping Policy）
3. 「ダイレクト出品」ボタンクリック
4. eBay APIを通じて即時出品
5. 出品結果の確認
   - 成功/失敗件数
   - エラー詳細表示
   - 取り下げファイルのダウンロード（前回出品の取り下げ用）

### 4.2 CSV出品（CSV Export）
**目的**: eBayの標準CSVアップロード機能を利用

#### 処理フロー
1. 出品セラー・ポリシー選択
2. 「CSV出品」ボタンクリック
3. CSVファイルが自動生成・ダウンロード
4. ユーザーが手動でeBay Seller Hubへアップロード
5. eBay側で一括処理

#### CSV仕様
- eBay File Exchange形式に準拠
- UTF-8エンコーディング
- Googleスプレッドシートでの編集推奨（Excel非推奨）
- カラム: Title, Price, Description, Category, Images, SKU, Condition など

### 4.3 SPECIFICSIN用CSV出力
**目的**: 外部ツール「Specific-in」との連携

- Specific-inユーザー向けの特殊フォーマット
- アイテムスペシフィックスの詳細出力

### 4.4 出品結果確認
- 出品成功/失敗の詳細レポート
- エラー内容の日本語表示
- 再出品のためのCSV編集ガイド

---

## 5. 在庫管理機能（Inventory Management）

### 5.1 在庫監視システム

#### 動作タイミング
- **11時**: 事前確認（リミット制限・アクティブファイルチェック）
- **13時**: 本番稼働開始
- **1日最大3回**実行可能（オプション）

#### アクティブファイル取得
**自動取得モード**:
- eBay商品自動同期設定をON
- 自動的にeBayから出品中商品リストを取得
- 対応件数: 50,000品〜400,000品（プラン依存）

**手動アップロードモード**:
1. eBay Seller Hub > Reports > Downloads
2. 「販売中の出品すべて」を選択
3. CSVダウンロード
4. DeepBayにアップロード

#### 在庫チェック処理
1. アクティブファイル内のSKUを基に商品を特定
2. 各商品の仕入元URLにアクセス
3. 仕入元での販売状況を確認
   - 在庫あり: 継続出品
   - 売り切れ: eBayから自動取り下げ（End Listing）
   - 価格変動: 価格改定トリガー

#### 暗号化復元機能
- DeepBay発行のDBK-ID（管理番号）から元URLを復元
- フォーマット: `ele_20250101_{英数字}`
- 暗号化によるURL保護

### 5.2 稼働状況確認
- 在庫管理結果ファイルのダウンロード
- 稼働日時の記録
- 取下げ結果ファイル
- 差分検知ファイル
- リバイスファイル

### 5.3 差分検知システム
**目的**: 仕入元の商品情報変更を検出

#### 検知項目
- 価格変動
- タイトル変更
- 在庫状況変化
- 画像変更

#### 設定パラメータ
- **差分検知タイプ**: 価格のみ/全項目
- **検知差分率（%）**: 変動率の閾値
- **検知差分項目**: 監視対象の選択

### 5.4 在庫管理詳細設定
- **販売時自動積み上げモード**: 売れた商品の自動処理
- **在庫管理稼働設定**: ON/OFF切り替え
- **eBay商品自動同期設定**: 自動/手動選択
- **セラーごとの個別設定**: 複数アカウント対応

---

## 6. 価格改定機能（Price Revision）

### 6.1 自動価格改定
**目的**: 仕入元価格変動による赤字防止

#### 処理タイミング
- 在庫管理と連動して毎日実行
- 価格変動を検知した場合にトリガー

#### 改定ロジック
1. 仕入元価格を取得
2. 設定済みの価格計算式を再適用
3. eBay側の販売価格を自動更新（Revise Item）
4. 差額が小さい場合はスキップ（閾値設定可能）

#### 改定対象
- 販売価格
- 送料設定
- オファー価格（ベストオファー）

---

## 7. SOLD積み上げ機能（SOLD Stacking）

### 7.1 仮想在庫管理
**目的**: 販売実績を可視化してバイヤーの信頼を獲得

#### 動作原理
1. 商品が売れる（eBayで1個販売）
2. DeepBayがeBay側の在庫数を自動調整
3. 「SOLD XX個」の表示を維持
4. 実際には仕入元から都度調達（無在庫販売）

#### 設定
- **在庫追加**: 新しい仕入先URLを登録
- **自動積み上げモード**: ON/OFF
- **初期在庫数**: 最初に表示する在庫数

#### 効果
- バンドワゴン効果（社会的証明）
- 「よく売れている商品」という印象
- 購買意欲の向上

---

## 8. データ管理機能（Data Management）

### 8.1 商品一覧管理
- **表示件数調整**: 10件〜200件/ページ（プラン依存）
- **フィルタリング**: タグ、日付、セラー、カテゴリ
- **ソート機能**: 価格、日付、タイトル順
- **担当者管理**: 複数ユーザーでの分担作業（リーダー機能）

### 8.2 ファイル出力
- **CSV出品ファイル**: eBayアップロード用
- **在庫管理結果ファイル**: 取下げ・差分・リバイス
- **オプションファイルDL**: 詳細データエクスポート

### 8.3 問い合わせ情報コピー
- サポート問い合わせ用の情報を自動生成
- 抽出ID、セラー情報、エラー内容を含む

---

## 9. ユーザー管理機能（User Management）

### 9.1 アカウント管理
- メールアドレス・パスワード認証
- プラン変更
- クレジットカード情報変更
- 料金プラン確認（加入状況タブ）

### 9.2 マルチユーザー対応
- **リーダー権限**: 全商品の編集・削除が可能
- **メンバー権限**: 担当商品のみ編集
- **担当者解除**: リーダーによる強制解除

### 9.3 外注管理
- Bee経由で外注スタッフを追加可能
- 権限の細かい設定

---

## 10. 設定管理機能（Settings Management）

### 10.1 抽出設定
- **危険セラー登録**: 除外対象のセラーリスト
- **危険単語登録**: 除外キーワードリスト
- **VERO設定**: 商標権侵害リスクのあるブランド登録

### 10.2 出品設定
- HTMLテンプレート管理
- ポリシー管理（Payment, Return, Shipping）
- カテゴリマスタ管理

### 10.3 その他設定
- 通知設定
- 言語設定（日本語UI）
- タイムゾーン設定

---

## 11. UI/UX機能

### 11.1 操作性向上機能
- **キーボードショートカット**: 高速操作対応
- **ドラッグ&ドロップ**: 画像並び替え
- **オートコンプリート**: カテゴリ・ブランド入力補助
- **プレビュー機能**: 出品前の表示確認

### 11.2 通知機能
- 処理進捗表示（％表示）
- 完了通知
- エラーアラート
- 在庫管理結果通知

### 11.3 ヘルプ・サポート
- **オレンジチャット**: 画面右下のチャットサポート
- **マニュアルサイト**: 詳細ドキュメント
- **YouTube動画**: 操作解説動画
- **FAQ**: よくある質問

---

## 12. 外部連携機能（External Integrations）

### 12.1 eBay連携
- **認証**: Bee経由でeBay APIトークン管理
- **出品**: Listing API
- **在庫管理**: Inventory API
- **価格改定**: ReviseItem API
- **情報取得**: GetMyeBaySelling API

### 12.2 対応ECサイト（スクレイピング）
プラン別で1〜18サイトに対応:
- メルカリ
- ヤフオク
- ラクマ
- 駿河屋
- デジマート
- オフモール
- トレファクファッション
- 楽天市場
- Yahoo!ショッピング
- vector-park
- 大黒屋
- Brand-off
- Gallery rare
- モノタロウ
- スニーカーダンク
- ヨドバシ
- その他

### 12.3 Beeツール連携
- eBayアカウント認証管理
- 複数アカウント切り替え
- 外注スタッフ管理

---

## 13. セキュリティ・データ保護

### 13.1 データ暗号化
- DBK-ID形式での商品URL暗号化
- SKU情報の保護

### 13.2 アクセス制御
- ユーザー認証
- セラーごとのデータ分離
- 権限ベースのアクセス管理

---

## 14. パフォーマンス・制約

### 14.1 処理時間
- 一括抽出: 数分〜10分（商品数・サイトによる）
- 在庫管理: 13時開始、所要時間はプラン依存
- CSV生成: 即時

### 14.2 制限事項
- 月間抽出回数制限（プラン依存）
- 月間在庫管理件数制限（プラン依存）
- 一括抽出あたりの取得商品数上限
- 画像枚数上限: 12枚
- タイトル文字数: 80文字（eBay制約）

---

## 15. 想定される技術スタック（推測）

### フロントエンド
- React / Vue.js（モダンなSPA構成）
- Bootstrap / Tailwind CSS（UIフレームワーク）
- JavaScript（ドラッグ&ドロップ、リアルタイム更新）

### バックエンド
- Node.js / Python（スクレイピング・API連携）
- データベース: PostgreSQL / MySQL
- キュー処理: Redis / RabbitMQ（非同期処理）
- スケジューラー: Cron / Bull（自動抽出・在庫管理）

### 外部サービス
- eBay API（Trading API, Finding API）
- 翻訳API: Google Translate API / DeepL API
- ストレージ: AWS S3 / Cloudinary（画像管理）

---

## 📊 データフローダイアグラム

```
[ECサイト] 
    ↓ スクレイピング
[DeepBay抽出機能]
    ↓ 編集・翻訳
[DeepBay商品DB]
    ↓ CSV/API出力
[eBay] ←→ [Bee認証ツール]
    ↓ 販売
[在庫管理機能] → [ECサイト再確認] → [価格改定/取下げ]
```

---

## 🎯 主要なビジネスロジック

### 商品抽出ロジック
1. URL解析 → サイト判定
2. スクレイピング実行（Puppeteer/Selenium推測）
3. データ正規化（価格、タイトル、画像URL）
4. 除外フィルター適用
5. 編集設定適用
6. DB保存

### 在庫管理ロジック
1. アクティブファイル取得（eBay API）
2. SKU → 仕入元URL復元
3. 並列アクセスで在庫確認
4. 差分検知（在庫/価格）
5. eBay API で取下げ/改定実行
6. 結果ファイル生成

### 価格計算ロジック
```
販売価格 = (仕入値 + 送料) × (1 + 利益率) + 固定額
オファー受諾価格 = 販売価格 × オファー受諾率
為替変動を考慮した自動調整
```

---

## ✅ 機能要件まとめ

| 機能カテゴリ | 主要機能 | 副次機能 |
|-------------|---------|---------|
| **商品抽出** | 一括抽出、シングル抽出、自動抽出 | URL解析、スクレイピング、データ正規化 |
| **商品編集** | 簡易編集、詳細編集、一括操作 | 自動翻訳、価格計算、画像管理、バリデーション |
| **出品管理** | ダイレクト出品、CSV出品、ポリシー管理 | エラーハンドリング、結果確認 |
| **在庫管理** | 自動在庫チェック、差分検知、取下げ | アクティブファイル管理、暗号化URL |
| **価格改定** | 自動価格更新、閾値設定 | 為替対応、オファー価格連動 |
| **SOLD積上** | 仮想在庫管理、自動調整 | 販売実績可視化 |
| **データ管理** | 商品一覧、フィルタ、ソート | CSV出力、問い合わせ情報生成 |
| **設定管理** | 一括編集設定、カテゴリ管理、抽出設定 | 危険ワード、VERO、HTMLテンプレート |
| **ユーザー管理** | 認証、権限、マルチアカウント | 外注管理、担当者割当 |
| **外部連携** | eBay API、Bee連携、ECサイトスクレイピング | 複数サイト対応、API認証管理 |

---

このウェブアプリは、**eBay無在庫販売のための包括的なオペレーションシステム**として設計されており、商品ソーシング→データ処理→出品→在庫管理→価格最適化という一連のワークフローを完全自動化可能にする、非常に高度な機能要件を持つプラットフォームです。